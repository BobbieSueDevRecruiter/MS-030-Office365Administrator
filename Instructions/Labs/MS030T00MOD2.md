

Module 2: Managing Microsoft 365 users and groups

Lab A: Managing Microsoft 365 users and passwords

### Exercise 1: Managing Microsoft 365 users and licenses by using the Microsoft 365 admin center

## Task 1: Create Microsoft 365 users

Holly Dickson is Adatum’s Enterprise Administrator. Since she doesn’t have a personal Microsoft 365 user account set up for herself, Holly initially signed into Microsoft 365 as the default Microsoft 365 MOD Administrator account. In this task, she will create a Microsoft 365 user account for herself, and she will assign her user account the Microsoft 365 Global Administrator role, which gives her the ability to perform all administrative functions within Microsoft 365.

‎You will then create several additional user accounts in the Microsoft 365 admin center, each of which you will later add to new security groups that you’ll also create. While Enterprise Admins typically do not add user accounts, this is a one-time task that you need to perform to prepare Adatum’s test environment for future lab exercises in this course.

**Important:** As a best practice in your real-world deployments, you should always write down the first global admin account’s credentials (in this lab, the MOD Administrator) and store it away for security reasons. This account is a non-personalized identity that owns the highest privileges possible in a tenant. It is **not** MFA activated (because it is not personalized) and the password for this account is typically shared among several users. Therefore, this first global admin is a perfect target for attacks, so it’s always recommended to create personalized service admins and keep as few global admins as possible. For those global admins that you do create, they should each be mapped to a single identity, and they should each have MFA enforced.

1. On the LON-DC1 VM, the **Microsoft 365 admin center** should still be open in Internet Explorer from the prior task. In the **Microsoft 365 admin center**, in the left-hand navigation pane, select **Users** and then select **Active users**. 

2. In the **Active users** list, you will see that the only user is the default **MOD Administrator** account. Since you’re taking on the role of Holly Dickson in this lab scenario, you will create a user account for yourself, and you will assign yourself the Microsoft 365 role of Global Administrator. You will also create several other user accounts that will be used throughout the remaining labs in this course.

3. In the **Active Users** window, select **Add a user**. 

4. In the **Set up the basics** window, enter the following information:

	- First name: **Holly**

	- Last name: **Dickson** 

	- Display name: When you tab into this field, **Holly Dickson** will appear.

	- Username: When you tab into this field, **Holly** will appear; leave this as the username<br/>
	
		‎**IMPORTANT:** To the right of the **Username** field is the domain field. It’s already prefilled with the custom **XXYYZZa.xtremelabs.us** on-premises domain; however, you must select the drop-down arrow and select the **M365xZZZZZZ.onmicrosoft.com** cloud domain instead (where ZZZZZZ is your tenant ID provided by your lab hosting provider).<br/>
	
		After configuring this field, Holly’s username should appear as:<br/>

		**Holly@M365xZZZZZZ.onmicrosoft.com**  
	
	- Password settings: select the **Let me create the password** option

	- Password: **Pa55w.rd** 

	- Uncheck the **Make this user change their password when they first sign in** checkbox 

5. Select **Next**.

6. In the **Assign product licenses** window, enter the following information:

	- Select location: **United States**

	- Licenses: Under **Assign user a product license**, select **Office 365 E5** 

7. Select **Next.**

8. In the **Optional settings** window, select the drop-down arrow to the right of **Roles.** 

9. In the **Roles information** that appears, uncheck **User (no administrator access).** By doing so, all the Microsoft 365 administrator roles are now enabled and available to be assigned.

10. Select **Global Administrator** and then select **Next**.

11. On the **You’re almost done – review and finish adding** window, review your selections. If anything needs to be changed, select the appropriate **Edit** link and make the necessary changes. Otherwise, if everything looks good, select **Finish adding**. 

12. On the **Holly Dickson has been added** page, select **Close.** 

13. Repeat steps 2-12 to add the following users with all the same data that was assigned to Holly, with the following exceptions: **Do NOT assign a role to any of the following users, and of this group, you should only assign a license to Alan Yoo. Alan and Holly should be the only users assigned a license.** <br/>

	**Licenses.** For Alan, you should assign an **Office 365 E5** license on the **Assign product licenses** page; he must be licensed for a later lab. For the remaining users, select the **Create user without product license (not recommended)** option on the **Assign product licenses** page. <br/>

	**Roles.** By default, a user is assigned **User role (no administration access)**; this will be sufficient for these users for now. In Lab 2 (Module 5), you will assign roles to the users. So when you reach the **Optional settings** window, select **Next** to bypass assigning a role. 

	- **Alan Yoo** with username **Alan**  

	- **Ada Russell** with username **Ada**

	- **Adam Hobbs** with username **Adam**

	- **Libby Hayward** with username **Libby**

    - **Laura Atkins** with username **Laura** 
    
    **IMPORTANT:** When you enter the **Username** for each of these users, make sure that in the domain field, you select the **M365xZZZZZZ.onmicrosoft.com** domain, just as you did when you created Holly’s user account record. The domain field will be prefilled with the custom **XXYYZZa.xtremelabs.us** on-premises domain; however, since the purpose of this task is to create Microsoft 365 user accounts, you must select the **M365xZZZZZZ.onmicrosoft.com** cloud domain instead (where ZZZZZZ is your tenant ID provided by your lab hosting provider).
‎
14. Remain logged into the domain controller VM with the Microsoft 365 admin center open in your browser for the next task.

## Task 2: Edit Microsoft 365 users

1. Continue in the Edge browser from the previous task.In the Microsoft 365 admin center tab,Select **Users** then **Active** **Users** list, Select the **Alan Yoo** user object.

2. On the right side, beside **Reset** **password**, Select the three doted elipsis, Select **Manage Contact information**.

. On the **Manage contact information**, and in the **Department** text box, type **Accounts**, Select **Save**, and then Select **Save changes**.

4. Then in the **Active** **Users** list On the right side, beside **Reset** **password**, Select the three doted elipsis, then select in the edit**Sign in status** section.

5. Select the **Sign-in blocked**, Select **Save**, and then Select **Close**.

6. Close the Alan Yoo page.

7. From the **Active** **Users** list, under **Display name**, Select **Ada** **Russell**.

8. On the right side, beside **Reset** **password**, Select the three doted elipsis, Select **Manage Contact information**.

9. Verify that the **Department** box displays **Accounts**, and then close the page.

10. Verify that **Sign-in status** is set to **Sign-in** **blocked**, and then close the Ada Russel page.

11. From the **Active** **Users** list, Select the **Libby** **Hayward** user object.

12. On the right side menu, Select **Delete user** **user**.

13. On the **Delete** **user** page, Select **Delete**, and then Select **Close**.

14. From the Microsoft Admin center In the left navigation pane, under the**Users** menu,Select **Deleted** **users**.

15. Verify that **Libby Hayward** is in this list.

16. In the **Deleted** **users** list, select **Libby** **Hayward**. 

17. On the toolbar, Select **Restore user**, and then on the **Restore** page, Select **Restore**. **Note: you can either have the system autogenerate the password or you can do it yourself. A good practice is to auto generate the password and then make then change their password upon first sign in.**

18. A new window will appear confirming that the user account has been restored and you have the option to send the password in an email. Select **close**.

19. From the Microsoft Admin center On the left navigation pane, point to **Users**, and Select **Active** **Users**.

20. Verify that **Libby Hayward** is in this list.

21. Close Microsoft Edge.

## Task : Verifying user settings

1. On LON-CL1, open Microsoft Edge, and then browse to **https://portal.office.com/**.

2. from the Microsoft 365 Sign portal sign in as **libby@yourdomain.hostdomain.com** with the temporary password that you noted in the previous task.

3. When you are prompted to change your password, on the **Update your password** page, in the **Current password** text box, type Lindsey’s temporary password.

4. In the **New** **password** and **Confirm** **password** text boxes, type **Pa55w.rd**, and then Select **Update** **password** **and** **sign** **in**.

5. If prompted, enter your new password again, and then Select **Sign in**.

6. Verify that you can access the Microsoft 365 portal home page.

7. Close Microsoft Edge.

8. Open Microsoft Edge, and then browse to **https://portal.office.com/**.

9. Sign in as **Libb@M365xZZZZZZ. hostdomain.com** with the temporary password that you noted in the previous task.

10. Verify that you cannot sign in and that the message states that your account has been locked.

11. Close Microsoft Edge.

12. Open Microsoft Edge, and then browse to **https://portal.office.com/**.

13. Sign in as **Admin@M365xZZZZZZ.onmicrosoft.com** with the password **Pa55w.rd**.

14. On the Microsoft 365 portal, Select **Admin**.

15. From the Microsoft Admin center In the left navigation pane, under the**Users** select **Active** **Users**.

16. In the **Active** **Users** list, Select **Alan** **Yoo**.

17. OThen in the **Active** **Users** list On the right side, beside **Reset** **password**, Select the three doted elipsis, then select in the **edit Sign in status** section.

18. On the **Sign in** **status** page, de-select  **Block this user from signing in**, Select **Save**, and then Select **Close**.

19. Close Microsoft Edge.

20. Open Microsoft Edge, and then browse to **https://portal.office.com/**.

21. Sign in as **Alan@M365xZZZZZZ.** **hostdomain.com** with the temporary password that you noted in the previous task.

22. On the **Update** **your** **password** page, in the **Current** **password** text box, type the temporary password.

23. In the **New** **password** and **Confirm** **password** text boxes, type **Pa55w.rd**, and then Select **Update** **password** **and** **sign in**.

24. On the Sign in again page, type **Pa55w.rd** as the password and Select **Sign** **in**.

25. Verify that you can access the Microsoft 365 portal.

26. Close Microsoft Edge.

 


**Results**: After completing this exercise, you should have created and managed user accounts and licenses according to business needs.


  
‎ 

### Exercise 2: Managing Microsoft 365 password policies

## Task 1: Configure the Microsoft 365 password policy

1. On the LON-DC1 VM, Open Microsoft Edge from the taskbar, and then browse to **https://portal.office.com/**.

2. Sign in as **Admin@M365xZZZZZZ.onmicrosoft.com** with the password **Pa55w.rd**.

. On the Microsoft 365 portal, Select **Admin**.

4. From the **Microsoft 365 admin center** locate the left side menu, point to **Settings**, and then Select **Org settings**.

5. In the **Org settings** menu, Select **Security and Privacy** located in the interface.

6. In the **Security and Privacy** page, Select the  **Password expiration policy**, a new window will appear and select the checkbox for **Set user passwords to expire after a number of days**.

 **Note:** This setting does not correspond with a real-world scenario. Use it as a sample scenario to verify the policy applied in the next exercise task.

7. In the **Days** **before** **passwords** **expire** set it to **14**, for the textbox **Days** **before** **a** **user** **is** **notified** **about** **expiration**; leave the default value of **14**the same, and then select **Save changes**.

8. Verify that the “Saved” message appears at the top of the page and then Select **Close**.

9. Close Microsoft Edge.

## Task 2: Validate the password policy
 this task will show you how to change the standard policy that controls at what tempo the user has to change there password. depending on the company that you work for, they may have different requirements when that user will need to update there password.
 a good practice is to have your users change there passwords every 90 days with a warning of 14 days prior to the update.

1. On the LON-DC1 VM, Open Microsoft Edge from the taskbar, and then browse to **https://portal.office.com**.

2. Sign in as **Alan@M365xZZZZZZ. hostdomain.com**, where ZZZZZZ is your unique M365x number, with the password **Pa55w.rd**.

. On the upper-right side of the window, verify that the notification appears with the following information: “Time to change your password. Your password will expire in 13 days.”

 **Note:** It might take a few minutes before the password change notification appears.

 **Note:** You have now verified that your password policy is applied. In a real-world scenario, after you verify that the password policy is applied, you would need to increase the number of days before the password expires, according to your organizational policy.

4. Close Microsoft Edge.

## Task : Enable multi-factor authentication
this task will show you how to enable Multi-factor authentication. This is a security standard for buisness's stepping stone to maintain user integretity. by design multi-factor is turned on by default for a Microsoft 365 tenant. but for the purposes of this lab, the service has been turned off to work efficiently.
However, tenants that are older than 2019 will need to be manually updated to reflect the standard if they haven't already been changed over.

1. On the LON-DC1 VM, Open Microsoft Edge from the taskbar, and then browse to **https://portal.office.com**.

2. Sign in as **Admin@M365xZZZZZZ.onmicrosoft.com**, where ZZZZZZ is your unique M365x number, with the password **Pa55w.rd**

3. From the Microsoft Edge browser in the Microsoft 365 portal page, Select **Admin**.

4. On the **Microsoft 365 admin center** page, on the left menu, select the **Users** option, and then Select **Active users**.

5. On the **Active users** page, Select **Multi-factor authentication** from the tool ribbon.

6. A new tab will open routing you to the  **Multi-factor authentication** page, Select  **Alan Yoo** from the user pane.

7.**Alan Yoo** will be selected,and there will be a option to the right that will be avialabe. Select the **Enable** option.

8. A new window will open and will warn you that your are about to enable Multi-factor Auth. select In the **enable multi-factor auth**, the window will change to a validation pane stating that the **updates** were **successful**,then Select **Close**.

9. You will be back On the **multi-factor authentication** page, Select **service settings** at the top of the page.

10. Under **verification options**, confirm that the **Call to phone** check box is deselected, Select **save**, and then Select **Close**. This will prevent users from using the call phone option as a way to valdiate there sign in.

11. Close Microsoft Edge.

 


**Results**: After completing this exercise, you should have configured and validated an Microsoft 365 password policy.


## Task: To prepare for the next lab

Keep the virtual machines running for the next lab in this module.

  
‎ 

Lab B: Managing Microsoft 365 groups and administration

### Exercise 1: Managing Microsoft 365 groups

## Task 1: Creating Microsoft 365 security groups

In the prior task, you added several new Microsoft 365 user accounts. In this task, you will create two new groups and then manage the groups by assigning users to them. You will also analyze the effect on group members when you delete a group.

1. On the LON-DC1 VM, in the **Microsoft 365 admin center**, select **Groups** in the navigation pane on the left, and then under it, select **Groups**. 

2. In the **Groups** window, select **Add a group** and then enter the following information for the new group: 

	- Type: **Office 365**

	- Name: **Inside Sales**

	- Group email address: When you tab into this field, **insidesales** will appear; leave this as the group email address <br/>
	
		**IMPORTANT:** To the right of the **Group email address** field is the domain field. It’s already prefilled with the custom **XXYYZZa.xtremelabs.us** on-premises domain, and if you select the drop-down arrow, no other domains appear (this is different from adding users). So the value in this field can be left as is.   <br/>
		
		After configuring this field, the Inside Sales group email address should appear as: **insidesales@XXYYZZa.xtremelabs.us**

	- Description: **Collaboration group for the Inside Sales team**

	- Privacy: leave the default setting of **Public**

	- Owner: **Alan Yoo**

3. Select **Add** and then **Close.**

4. In the **Groups** window, select **Add a group** and then enter the following information for the new group:

	- Type: **Security**

	- Name: **Sales**

	- Description: **Sales Department users**<br/>

	**Note:** there is no owner, email address, or privacy setting for Security groups

5. Select **Add** and then **Close.**

6. If the new groups do not appear in the **Groups** list, select the **Refresh** icon to the right of the URL in Internet Explorer. Both groups should now appear. 

7. You’re now ready to add members to the groups. In the list of **Groups**, select the **Inside Sales** group, which opens a window for the group. 

8. In the **Inside Sales** group window, select **Members**.

9. In the **Members** section, you can see that there are zero (0) members. Select **View all and manage members** to add members to the group. 

10. In the **Inside Sales** group window, select **Add members**. This displays the list of current users.

11. In the list of users, select **Ada Russell** and **Alan Yoo** and then select **Save**. 

12. Select **Close**. This displays the list of users for this group. Select **Close** again. 

13. On the **Inside Sales** window, select the **X** in the upper right-hand corner to close the window. 

14. In the **Groups** window, select **Add a group** and then enter the following information for the new group:

	- Type: **Security**

	- Name: **Accounts Receivable**

	- Description: **Accounts Receivable department users** 

15. Select **Add** and then **Close.**

16. If the Accounts Receivable group does not appear in the **Groups** list, select the **Refresh** icon to the right of the URL in Internet Explorer. The group should now appear.

17. In the **Groups** list, select the **Accounts Receivable** group, which opens a window for the group. 

18. In the **Accounts Receivable** group window, select **Members**.

19. In the **Members** section, you can see that there are zero (0) group owners and members. Select **View all and manage owners** to add an owner for the group.

20. In the **Accounts Receivable** group window, select **Add owners**. This displays the list of current users.

21. In the list of users, select **Libby Hayward** and then select **Save**. 

22. Select **Close**. This displays the list of owners for this group. Select **Close** again. 

23. In the **Accounts Receivable** group window, select **View all and manage members** to add members to the group. 

24. In the **Accounts Receivable** group window, select **Add members**. This displays the list of current users.

25. In the list of users, select **Adam Hobbs** and **Libby Hayward** and then select **Save**. 

26. Select **Close**. This displays the list of users for this group. Select **Close** again. 

27. On the **Accounts Receivable** window, select the X in the upper right-hand corner to close the window. This will return you to the list of **Groups** in the **Microsoft 365 admin center**. 

28. You now want to test the effect of deleting a group. In the list of **Groups,** select the vertical ellipsis icon (**More actions**) to the right of the **Inside Sales** group. In the menu box, select **Delete group**. 

29. In the **Delete group** window, select the **Delete** button.

30. Once the group is deleted, select **Close**. 

31. This will return you to the list of **Groups** in the **Microsoft 365 admin center**. The **Inside Sales** group should no longer appear. 

32. To verify whether deleting this group affected any of its members, select **Users** and then **Active Users** in the navigation pane on the left-hand side of the Groups window. 

33. In the list of **Active** **Users** verify that the two members of this group, Alan Yoo and Ada Russell, still exist in the list of users. This verifies that deleting a group does not delete the user accounts that were members of the group.

34. Remain logged into the domain controller VM with the Microsoft 365 admin center open in your browser for the next task.



**Results**: After completing this exercise, you should have created and managed security groups.


  
‎ 

### Exercise 2: Managing Microsoft 365 users and groups by using Windows PowerShell

Powershell can improve the way an administrator can automate and streamline complicated or simple tasks that can soak up time from a work day. By reducing the amount of interfaces and giving commands directly to the tenant. 
Tasks that would take hours by hand can be reduced to minutes or even secounds with powershell.

## Task 1: Installing Microsoft Azure Active Directory module for Windows PowerShell

In this task we are going to be laying the foundation for editing and managing the Microsoft 365 tenant with the use of powershell. the next step is to install The Microsoft Online Services Sign-In Assistant provides end user sign-in capabilities to Microsoft Online Services, such as Office 365. 
The MOS SIA installs client components that allow common applications, such as Microsoft Outlook and Lync, to authenticate to Microsoft Online Services. The MOS SIA can also provide an improved sign-in experience, such that end users can access Microsoft Online Services without having to re-enter their credentials (such as a user name or password). This download is intended for IT Professionals, for distribution to managed client systems as part of an Office 365 client deployment, via System Center Configuration Manager (SCCM) or similar software distribution systems.

1. On LON-CL1, open Microsoft Edge, and browse to **http://aka.ms/t01i1o**

2. Under Microsoft Online Services Sign-In Assistant for IT Professionals RTW, Select **Download**.

. Select the **msoidcl_64.msi** check box, and then Select **Next**.

4. When prompted at the bottom of the page, Select **Save**.

5. When the download finishes, Select **Run**. 

6. In the Microsoft Online Services Sign-in Assistant Setup wizard, Select **I accept the terms in the License Agreement and Privacy Statement**, and then Select **Install**.

7. In the **User Account Control** dialog box, Select **Yes**.

8. On the **Completed the Microsoft Online Services Sign-in Assistant Setup Wizard** page, Select **Finish**.

9.On LON-CL1, on the desktop,select the seach icon and type **Powershell** then right-Select and run as **Administrator**.

10. type the following commands:
 This command will install the Mircrosoft online module.
		
		Install-Module Msoline

11. When prompted type **'Y'** to confirm the installation.

  This command will install the Azure AD module.
		
		Install-module AzureADPreview

12.When prompted type **'Y'** to confirm the installation.

 Keep the powershell console open for the next task.

## Task 2: Create new users and assign licenses by using Windows PowerShell

1. On LON-CL1, on the desktop,select the seach icon and type **Powershell** then right-Select the **Windows Azure Active Directory Module for Windows PowerShell** shortcut, and then Select **Run as administrator**.

2. If a **User Account Control** dialog box appears, Select **Yes**.

. At the command prompt, type the following command, and then press Enter:

This command will start the connection with the Microsoft 365 tenant.

		Connect-MsolService


4. In the **Enter Credentials** dialog box, sign in as **Admin@M365x****ZZZZZZ****.onmicrosoft.com**, where ZZZZZZ is your unique M365x number, with the password **Pa55w.rd**.

5. At the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:
 
 This command will create a new user named Cathrine Richard with her password set to  Pa55w.rd and your location set to CH.

		New-MsolUser –UserPrincipalName Catherine@yourdomain.hostdomain.com –DisplayName “Catherine Richard” –FirstName “Catherine” –LastName “Richard” –Password ‘Pa55w.rd’ –ForceChangePassword $false –UsageLocation “CH”


6. At the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:

This command will create a new user named Tameka Reed with her password set to  Pa55w.rd and your location set to CH. and she won't need to change her password once she signed in.'

 		New-MsolUser –UserPrincipalName tameka@yourdomain.hostdomain.com –DisplayName “Tameka Reed” –FirstName “Tameka” –LastName “Reed” –Password ‘Pa55w.rd’ –ForceChangePassword $false –UsageLocation “CH”


7. To determine which users are unlicensed, at the command prompt, type the following command, and then press Enter:

This command will show all the licensed users.

		Get-MsolUser -UnlicensedUsersOnly


8. To view the available licenses, at the command prompt, type the following command, and then press Enter:

This command will show all available licensese inside the Microsoft 365 Enviroment.

		Get-MsolAccountSku


9. To license Catherine Richard, at the command prompt, type the following command, and then press Enter; replace M365xZZZZZZ in the –AddLicenses attribute with the onmicrosoft.com domain name provided by the hosting provider:

This command will give add a Enerprise E5 license to the new user catherine.

		Set-MsolUserLicense -UserPrincipalName Catherine@yourdomain.hostdomain.com –AddLicenses “M365xZZZZZZ:ENTERPRISEPREMIUM”


10. To license Tameka Reed, at the command prompt, type the following command, and then press Enter; replace M365xZZZZZZ in the –AddLicenses attribute with the onmicrosoft.com domain name provided by the hosting provider:

This command will add a Enterprise E5 license to the new user Tameka.

		Set-MsolUserLicense -UserPrincipalName Tameka@yourdomain.hostdomain.com –AddLicenses “M365xZZZZZZ:ENTERPRISEPREMIUM”


11. To prevent a user from signing in, at the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:

This command will block access for the new user Catherine.

		Set-MsolUser -UserPrincipalName Catherine@yourdomain.hostdomain.com -BlockCredential $true


12. To delete a user, at the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:

This command will delete the new user Catherine without requesting a confirmation.

		Remove-MsolUser –UserPrincipalName Catherine@yourdomain.hostdomain.com –Force


13. To view the **Deleted Users** list, at the command prompt, type the following command, and then press Enter:

This command will return a list of deleted users.

		Get-MsolUser –ReturnDeletedUsers


14. Verify that Catherine Richard is in the list of deleted users. Note that it specifies that she is still licensed.

15. To restore a deleted user, at the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:

This command will restore the user Catherine to the active users pool.

		Restore-MsolUser –UserPrincipalName Catherine@yourdomain.hostdomain.com


16. To view the deleted users list, at the command prompt, type the following command, and then press Enter:

This command will return a list of deleted users.

		Get-MsolUser –ReturnDeletedUsers


17. Verify that Catherine Richard is no longer in the list of deleted users.

18. To view the active users list, at the command prompt, type the following command, and then press Enter:

This command will retieve all the users that are in the Micosoft 365 tenant.

		Get-MsolUser


19. Verify that Catherine Richard is in the active users list.

20. To allow a user to sign in, at the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:

This command will unblock Catherine from signing in to Microsoft 365. 

		Set-MsolUser -UserPrincipalName Catherine@yourdomain.hostdomain.com -BlockCredential $false


## Task : Modify existing users by using Windows PowerShell

1. On LON-CL1, on the taskbar, Select **File Explorer**.

2. Navigate to **C:\labfiles**, right-Select **O365users.csv**, point to **Open with**, and then Select **Notepad**.

. In Notepad, Select **Edit**, and then Select **Replace**.

4. In the **Find what** text box, type **y****ourdomain.hostdomain.com**, where yourdomain is your unique domain name.

5. In the **Replace with** text box, type your unique public domain name value, and then Select **Replace All**. 

6. In the **Find what** text box, type M365x**yyxxxx:ENTERPRISEPACK**.

7. In the **Replace with** text box, type your unique M365xZZZZZZ value followed by **:ENTERPRISEPREMIUM**, and then Select **Replace All**. 

 **Note:** M365xyyxxxx in this step must be the onmicrosoft.com domain name.  

8. Close O365users.csv, and then in the **Notepad** message box, Select **Save**.

9. To bulk import several users from a comma-separated value (CSV) file, copy and paste this code into the Administrator: Windows Azure Active Directory Module for Windows PowerShell window on LON-CL1, and then press Enter:

This Command will import the data from O365users.csv and bulk import all users in the list.

		Import-Csv -Path C:\labfiles\O365Users.csv | ForEach-Object { New-MsolUser -UserPrincipalName $_."UPN" -AlternateEmailAddresses $_."AltEmail" -FirstName $_."FirstName" -LastName $_."LastName" -DisplayName $_."DisplayName" -BlockCredential $False -ForceChangePassword $False -LicenseAssignment $_."LicenseAssignment" -Password $_."Password" -PasswordNeverExpires $True -Title $_."Title" -Department $_."Department" -Office $_."Office" -PhoneNumber $_."PhoneNumber" -MobilePhone $_."MobilePhone" -Fax $_."Fax" -StreetAddress $_."StreetAddress" -City $_."City" -State $_."State" -PostalCode $_."PostalCode" -Country $_."Country" -UsageLocation $_."UsageLocation" }


10. To view the **Active Users** list, at the command prompt, type the following command, and then press Enter:

This command will get all the users inside the Microsoft 365 tenant.

		Get-MsolUser


11. Switch back to Microsoft Edge, Select **Admin**.

12. On the Home page, Select **Users**.

13. Review the active users that you just imported.

14. On the Admin center menu, Select **Exchange**.

15. Under recipients, Select **mailboxes** and review the mailboxes and associated email addresses that were created.

## Task 4: Configure groups and group membership by using Windows PowerShell

1. To create a Marketing group, at the command prompt, type the following command, and then press Enter:

This Command will create a new Micrsosoft 365 group called Marketing department users. 

		New-MsolGroup –DisplayName “Marketing” –Description “Marketing department users”


2. To configure a variable for the group, at the command prompt, type the following command, and then press Enter:

This Command will create a macro commandlete that will retrieve all objects that belong to Marketing.

		$MktGrp = Get-MsolGroup | Where-Object {$_.DisplayName -eq "Marketing"}


. To configure a variable for the first user account, at the command prompt, type the following command, and then press Enter:

This Command will create a macro Commandlete that will retrieve all users that have a display name Catherine Richard.

		$Catherine = Get-MsolUser | Where-Object {$_.DisplayName -eq "Catherine Richard"}


4. To configure a variable for the second user account, at the command prompt, type the following command, and then press Enter:

This Command will create a macro Commandlete that will retrieve all users that have a display name Tameka Reed.

		$Tameka = Get-MsolUser | Where-Object {$_.DisplayName -eq "Tameka Reed"}


5. To add Catherine Richard to the Marketing group, at the command prompt, type the following command, and then press Enter:

This command will add members name catherine Richard to newly created group Marketing department users.

		Add-MsolGroupMember -GroupObjectId $MktGrp.ObjectId -GroupMemberType "User" -GroupMemberObjectId $Catherine.ObjectId


6. To add Tameka Reed to the Marketing group, at the command prompt, type the following command, and then press Enter:

This command will add members name Tameka Reed to newly created group Marketing department users.

		Add-MsolGroupMember -GroupObjectId $MktGrp.ObjectId -GroupMemberType "User" -GroupMemberObjectId $Tameka.ObjectId


7. To verify the members of the Marketing group, at the command prompt, type the following command, and then press Enter:

This command will retrieve all members associated with the new group Marketing department users.

		Get-MsolGroupMember -GroupObjectId $MktGrp.ObjectId


## Task 5: Configure user passwords by using Windows PowerShell

1. At the command prompt, type the following command, and then press Enter; ZZZZZZ is your unique M365x number:

This command will set the password expiration policy for the Domain  “M365xZZZZZZ.onmicrosoft.com” with the validation period of 90 days and a notification period of 14 days.

		Set-MsolPasswordPolicy -DomainName “M365xZZZZZZ.onmicrosoft.com” –ValidityPeriod “90” -NotificationDays “14”


2. At the command prompt, type the following command, and then press Enter; yourdomain is your unique domain name:

This command will set the a new password for Tameka as Pa55w.rd123

		Set-MsolUserPassword –UserPrincipalName “Tameka@yourdomain.hostdomain.com” –NewPassword ‘Pa55w.rd123’


. At the command prompt, type the following command, and then press Enter:

This command will set all users password parameter to never expire as false.

		Get-MsolUser | Set-MsolUser –PasswordNeverExpires $false 


 


**Results**: After completing this exercise, you should have created new users, assigned licenses, modified existing users, and configured groups and user passwords by using the Windows PowerShell command-line interface.


  
‎ 

### Exercise : Configuring service administrators

You are the Enterprise Administrator for Adatum Corporation, and you have Microsoft 365 deployed in a virtualized lab environment. In this lab, you will manage administration delegation by assigning administrator roles to several of your users, configure Azure Rights Management and Compliance, and monitor and troubleshoot Microsoft 365. 

In this lab, you will take on the persona of Holly Dickson, Adatum’s Enterprise Administrator. If you’ll recall, in the prior lab you created Holly’s Microsoft 365 user account and assigned her the Microsoft 365 Global Administrator role. As Holly, you will now begin managing Adatum’s Microsoft 365 tenant.

### ‎Task 1 - Assign Delegated Administrators in the Microsoft 365 Admin Center

As Holly Dickson, Adatum’s Enterprise Administrator (and Microsoft 365 Global Admin), you will use the Microsoft 365 Admin Center to assign administrator rights to several users. 

1. If you’re not logged into the Domain Controller VM (LON-DC1) as **ADATUM\Administrator** and password **Pa55w.rd**, then please do so now.

2. After completing Lab 1, you are still signed into the **Microsoft 365 admin center** as the **MOD Administrator** account. In this lab, you will begin implementing Adatum’s Microsoft 365 pilot project as Holly Dickson, Adatum’s Enterprise Admin (whom you previously assigned a Microsoft 365 Global Admin role). Therefore, you must log out of Microsoft 365 as the MOD Administrator and log back in as Holly.<br/>

	On the Microsoft 365 admin center tab, select the user icon for the **MOD Administrator** (the **MA** circle) in the upper right corner of your browser, and in the **My account** pane, select **Sign out.** <br/>
	
	**Important:** When signing out of one account and signing in as another, you should close all your browser tabs except for your current tab. This is a best practice that helps to avoid any confusion by closing the windows associated with the prior user. Please close all other browser tabs now. 
	
3. In Internet Explorer browser, navigate to **https://portal.office.com**. 

4. In the **Pick an account** window, only the admin account that you just logged out from appears. Select **Use another account**. 

5. In the **Sign in** window, enter **Holly@M365xZZZZZZ.onmicrosoft.com** (where ZZZZZZ is your unique tenant ID provided by your lab hosting provider). Select **Next**.

6. In the **Enter password** window, enter **Pa55w.rd** and then select **Sign in**.

7. If a **Get your work done with Office 365** window appears, select the **X** to close it. 

8. In the **Office 365 home page**, select **Admin** to open the Microsoft 365 admin center.

9. In the **Good morning/afternoon/evening Holly Dickson** window, select **Get started**.

10. In the **Microsoft 365 admin center**, in the left-hand navigation pane, select **Users** and then **Active Users**. 

11. In the **Active users** list, select **Adam Hobbs**. 

12. Adam Hobbs’s properties window displays, and the **Account** tab is displayed by default. Under the **Roles** section, select **Manage roles**. 

13. In the **Manage admin roles** window, uncheck the **User (no administrator access)** checkbox. This enables the roles. 

14. Scroll down, and under the **Billing** section, select the **Billing administrator** role and then select **Save changes**. 

15. Select the **X** in the upper-right corner of the screen to close the **Admin roles updated** window.

16. Select the **X** in the upper-right corner of the screen to close the **Adam Hobbs** properties window. This returns you to the **Active users** list. 

17. Repeat steps 10 through 15 for **Ada Russell.** Assign Ada to both the **User management administrator** role and the **Helpdesk Administrator** role. 

18. Remain logged into the domain controller VM and the Microsoft 365 admin center as Holly Dickson.

## Task 2: Manage service administration with Windows PowerShell

1.This task is similar to the prior one in that you will assign administrator rights to users; however, in this case, you will use Windows PowerShell to perform these functions rather than the Office 365 Admin Center. This will give you experience performing this management function in PowerShell, since some administrators prefer performing maintenance such as this using PowerShell.  

‎In this task, you will log into PowerShell as Holly Dickson, who is Adatum’s Enterprise Administrator.

1. On the LON-DC1 VM, navigate to the Windows PowerShell window that you left open from a previous task in Lab 1. If you closed the PowerShell window, then open it again using the same instruction as before. 

2. You should begin by running the following command that connects your PowerShell session to the Microsoft Online Service:  <br/>

	‎**Connect-MsolService**  
	
3. In the **Sign in** dialog box, log in as **Holly@M365xZZZZZZ.onmicrosoft.com** (where ZZZZZZ is your unique tenant ID provided by your lab hosting provider) with password **Pa55w.rd**. 

4. PowerShell's execution policy settings dictate what PowerShell scripts can be run on a Windows system. Setting this policy to Unrestricted enables Holly to load all configuration files and run all scripts. At the command prompt, type the following command, and then press Enter:   <br/>

	‎**Set-ExecutionPolicy unrestricted**<br/>

	‎If you are prompted to verify that you want to change the execution policy, enter **A** to select **[A]** **Yes to All.** 

5. Holly now wants to assign **Libby Hayward** to the **Service Support Administrator** role. In the Windows PowerShell window, at the command prompt, type the following command, and then press:  <br/>

	**Add-MsolRoleMember -RoleName "Service Support Administrator” –RoleMemberEmailAddress Libby@M365xZZZZZZ.onmicrosoft.com** (where ZZZZZZ is your unique tenant ID provided by your lab hosting provider) 

6. Holly now wants to assign **Laura Atkins** to the **Company Administrator** role. At the command prompt, type the following command, and then press Enter:   <br/>

	‎**Add-MsolRoleMember -RoleName "Company Administrator" -RoleMemberEmailAddress Laura@M365xZZZZZZ.onmicrosoft.com**  (where ZZZZZZ is your unique O365 Credentials) 

7. You now want to verify which users have been assigned to certain roles. Displaying the users assigned to a role is a two-step process.<br/>

	‎**Note:** Do NOT perform the following commands just yet – this is an informational step whose purpose is to simply describe what you will be doing in the remaining steps in this task. Once you understand what you will be doing, then proceed to step 8.

	- You will begin by running a command that creates a macro command ($role) that states that anytime $role is used in a cmdlet, it should retrieve all users assigned to whichever role name you’re validating.  <br/> 
		
		**&dollar;role = Get-MsolRole -RoleName "enter name of role here"**
			
	- After creating the macro in the prior step, you will then run the following command that directs PowerShell to display all object IDs for the users who have been assigned to the name of the role that you invoked in the previous $role macro.  <br/>
	
		**Get-MsolRoleMember -RoleObjectId $role.ObjectId**  ‎
			
8. You should now run the following two commands to verify that Libby was assigned to the Service Support Administrator role:  <br/> 

	**&dollar;role = Get-MsolRole -RoleName "Service Support Administrator"**<br/>

	‎**Get-MsolRoleMember -RoleObjectId $role.ObjectId**
	
9. Verify that **Libby Hayward** is in the list of users who have the **Service Support Administrator** role. 

10. You should now run the following two commands to verify that Laura was assigned to the Company Administrator role.<br/>

	**&dollar;role = Get-MsolRole -RoleName "Company Administrator"**<br/>

	‎**Get-MsolRoleMember -RoleObjectId $role.ObjectId**   

11. Verify that **Laura Atkins** is in the list of users who have the **Company Administrator** role.   <br/>

	‎**Important:** Since Global Administrators are also automatically assigned to the Company Administrator role, notice that Holly Dickson is also in this list even though she wasn’t manually assigned the role. Finally, notice that the system admin (the MOD Administrator) is also assigned to this role by default. 
	
12. You should now run the following two commands to verify which Adatum users have been assigned to the Billing Administrator role.  <br/>

	**&dollar;role = Get-MsolRole -RoleName "Billing Administrator"**  <br/>

	‎**Get-MsolRoleMember -RoleObjectId $role.ObjectId** 

13. Verify that **Adam Hobbs** is in the list of users who have the **Billing Administrator** role (you assigned Adam to this role in the prior task using the Microsoft 365 admin center). 

14. Leave your Windows PowerShell session open for future lab exercises; simply minimize it before going on to the next task.

## Task : Verify service administration

In this task, you will log into the Client 1 (LON-CL1) VM and then log into the Microsoft 365 admin center as various users to confirm several of the changes that you made when managing your administrative delegation in the prior tasks. 

1. Switch to the Client 1 VM (LON-CL1) by selecting the **Virtual machine** field at the top of the screen and then selecting **LON-CL1**.

2. On the log-in screen, you will log in as the **Administrator** account with a password of **Pa55w.rd**.

3. On the **Networks** window that appears, select **No**.

4. On the taskbar, select the **Microsoft Edge** icon. 

5. In your **Edge** browser navigate to **https://portal.office.com**. In the **Pick an Account** window, if **Alan Yoo** is listed then select his username; otherwise, select **Use another account** and log in as [](https://login.microsoftonline.com/)**Alan@M365xZZZZZZ.onmicrosoft.com** (where ZZZZZZ is your unique tenant ID provided by your lab hosting provider).   <br/>

	‎**Note:** When entering Alan’s password, you must enter the temporary password that was assigned to Alan’s account in the prior exercise when you reset Alan’s account and had the system automatically assign him a temporary password. 

6. If a **Get your work done with Office 365** window appears, select the **X t**o close it.

7. In the **Office 365 home page**, note how the **Admin** option is not available since Alan was never assigned an administrator role. 

8. In **Microsoft Edge**, at the top right of the **Office 365 home page**, select the user icon for **Alan Yoo**, and in his **My account** pane, select **Sign out.**   <br/>

	‎**Important:** When signing out of one account and signing in as another, you should close all your browser tabs except for your current tab. This is a best practice that helps to avoid any confusion by closing the windows associated with the prior user. Please close all other browser tabs now.  
	
9. In your **Edge** browser, navigate to **https://portal.office.com** and repeat the previous sign-in steps to sign in as **Ada Russell** with a username of **Ada@M365xZZZZZZ.onmicrosoft.com** (where ZZZZZZ is your unique tenant ID provided by your lab hosting provider) with the password **Pa55w.rd.** 

10. Since Ada has been assigned to an administrator role, note how **Admin** appears in the **Office 365 home page**. Select **Admin.**

11. In the **Good morning/afternoon/evening Ada Russell** window, select **Get started**.

12. On the **Microsoft 365 admin center**, select **Users** on the left-hand navigation pane and then select **Active users**. 

13. As the **Helpdesk administrator**, Ada has permission to change user passwords. In this case, Libby Hayward and Alan Yoo have reported that their passwords have been compromised. Ada has been asked to reset their passwords to a different value.   <br/>

	‎In the **Active users** list, select the **key icon (Reset a password)** to the right of **Libby Hayward’s** name. 

14. In the **Reset password** window for Libby, ensure the **Auto-generate password** option is selected, and then uncheck the **Require this user to change their password when they first sign in** checkbox if it was selected. 

15. Select **Reset**.

16. You should receive an error message indicating that you cannot reset Libby’s password because she has admin roles. In Libby’s case, she was assigned to the Service Support Admin role. Since only Global Admins can change another admin’s password, you’ll need to ask Holly Dickson to make this change. Select **Close**. 

17. In the **Active users** list, select the **key icon (Reset a password)** to the right of **Alan Yoo’s** name. 

18. In the **Reset password** window for Alan, ensure the **Auto-generate password** option is selected, and then uncheck the **Require this user to change their password when they first sign in** checkbox if it was checked. 

19. Select **Reset**.<br/>

	**IMPORTANT:** It is very important that you write down the temporary password that was automatically generated for Alan’s account. You will need this password in the next exercise when you log into Office 365 as Alan. Once you write down this password, select the **Send password in email** checkbox, and then select **Close.**

20. Select **Send email and close.** 

21. Management has recently discovered that Adam Hobbs’s username may have been compromised. As a result, Ada has been asked to block Adam’s account so that no one can sign in with his username until management is able to determine the extent of the issue. In the **Active users** list, select the circle to the left of **Adam Hobbs’s** name (do NOT select Adam’s name itself). 

22. In the menu bar at the top of the page, select the **ellipsis icon** to display a drop-down menu of additional options. Select **Edit sign-in status**.

23. In the **Block this user?** window, select the **Block this user from signing in** checkbox, and then select **Save changes.** 

24. Close the **Block this user?** window by selecting **Cancel**. 

25. Ada has finished maintaining these accounts, so log out of the Microsoft 365 admin center by selecting the user icon for **Ada Russell** (the **AR circle**), and in her **My account** pane, select **Sign out.** 

26. Once Ada is signed out, close Microsoft Edge. 
 


**Results**: After completing this exercise, you should have assigned service administrators in the Microsoft 365 admin center, managed service administration with Windows PowerShell, and verified service administration.
